{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/hide-on-scroll.js"],"names":[],"mappings":"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","file":"../src/hide-on-scroll.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","// HIDE ON SCROLL\r\n// ==============\r\n\r\n// Constants\r\n// ---------\r\n\r\nconst defaultSelector = '.hide-on-scroll';\r\nconst defaultOptions  = {\r\n    delay: 2000,\r\n    position: 0\r\n};\r\n\r\nconst attrDelay       = 'data-hide-delay';\r\nconst attrPosition    = 'data-hide-position';\r\n\r\nconst classHidden     = 'is-hidden-on-scroll';\r\nconst classLocked     = 'is-locked';\r\nconst classNoAnim     = 'no-anim';\r\nconst classTop        = 'at-top';\r\n\r\n// Static Members\r\n// --------------\r\n\r\nlet _instanceCount = 0;\r\nlet _isScrollingUpwards = false;\r\nlet _scrollPosition = window.scrollY || window.pageYOffset;\r\n\r\n// Utility Methods\r\n// ---------------\r\n\r\nfunction assign(target, firstSource) {\r\n    if (target === undefined || target === null) {\r\n        throw new TypeError('Cannot convert first argument to object');\r\n    }\r\n    var to = Object(target);\r\n    for (var i = 1; i < arguments.length; i++) {\r\n        var nextSource = arguments[i];\r\n        if (nextSource === undefined || nextSource === null) {\r\n            continue;\r\n        }\r\n        var keysArray = Object.keys(Object(nextSource));\r\n        for (var nextIndex = 0, len = keysArray.length; nextIndex < len; nextIndex++) {\r\n            var nextKey = keysArray[nextIndex];\r\n            var desc = Object.getOwnPropertyDescriptor(nextSource, nextKey);\r\n            if (desc !== undefined && desc.enumerable) {\r\n                to[nextKey] = nextSource[nextKey];\r\n            }\r\n        }\r\n    }\r\n    return to;\r\n}\r\n\r\nfunction toggleClass(element, className, force) {\r\n    if (force) {\r\n        element.classList.add(className);\r\n    } else {\r\n        element.classList.remove(className);\r\n    }\r\n}\r\n\r\n// HideOnScroll\r\n// ------------\r\n\r\nexport default class HideOnScroll {\r\n\r\n    static get instanceCount() { return _instanceCount; }\r\n    static get isScrollingUpwards() { return _isScrollingUpwards; }\r\n    static get scrollPosition() { return _isScrollingUpwards; }\r\n\r\n    get items() { return this._items; }\r\n    get options() { return this._options; }\r\n    get selector() { return this._selector; }\r\n\r\n    constructor (selector = defaultSelector, options = {}) {\r\n        // Selector\r\n        this._selector = selector;\r\n        // Options\r\n        this._options = assign({}, defaultOptions, options);\r\n        // Items\r\n        this._items = [];\r\n        let nodeList = document.querySelectorAll(selector);\r\n        for (let i = 0; i < nodeList.length; i++) {\r\n            this._items.push(new HideOnScrollItem(this, nodeList[i]));\r\n        }\r\n        // On Scroll\r\n        if (_instanceCount == 0) {\r\n            window.addEventListener('scroll', (e) => {\r\n                this.refresh(e);\r\n            });\r\n        }\r\n        _instanceCount++;\r\n    }\r\n\r\n    refresh(e) {\r\n        let position = window.scrollY || window.pageYOffset;\r\n        if (position == _scrollPosition) return;\r\n        toggleClass(document.body, classTop, (position <= 0));\r\n        _isScrollingUpwards = (position < _scrollPosition || position <= 0)\r\n        _scrollPosition = position;\r\n        for (let i = 0; i < this._items.length; i++) this._items[i].refresh();\r\n    }\r\n\r\n}\r\n\r\n// HideOnScrollItem\r\n// ----------------\r\n\r\nclass HideOnScrollItem {\r\n\r\n    get element() { return this._element; }\r\n    get options() { return this._options; }\r\n    get parent() { return this._parent; }\r\n\r\n    constructor(parent, element) {\r\n        this._parent = parent;\r\n        this._element = element;\r\n        this._options = assign({}, parent._options);\r\n        this._setOptionInt('delay', attrDelay);\r\n        this._setOptionInt('position', attrPosition);\r\n    }\r\n\r\n    clearTimeout() {\r\n        clearTimeout(this._timeoutId);\r\n        this._timeoutId = undefined;\r\n    }\r\n\r\n    hide() {\r\n        if (_scrollPosition <= this._options.position || this._element.classList.contains(classLocked)) return;\r\n        this._timeoutId = undefined;\r\n        this._element.classList.add(classHidden);\r\n    }\r\n\r\n    refresh() {\r\n        this.clearTimeout();\r\n        this._element.classList.remove(classNoAnim);\r\n        let show = (_isScrollingUpwards || _scrollPosition <= this._options.position || this._element.classList.contains(classLocked));\r\n        if (show) {\r\n            this._element.classList.remove(classHidden);\r\n            this._timeoutId = setTimeout(() => { this.hide() }, this._options.delay);\r\n        } else if (this._timeoutId == undefined) {\r\n            this._element.classList.add(classHidden);\r\n        }\r\n    }\r\n\r\n    _setOptionInt(option, attr) {\r\n        let value = this._element.getAttribute(attr);\r\n        if (value) {\r\n            this._options[option] = parseInt(value);\r\n        }\r\n    }\r\n\r\n}\r\n\r\n// Globals\r\n// -------\r\n\r\nwindow.HideOnScroll = HideOnScroll;"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvaGlkZS1vbi1zY3JvbGwuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7Ozs7Ozs7O0FDQUE7QUFDQTtBQUVBO0FBQ0E7QUFFQSxJQUFNLGVBQWUsR0FBRyxpQkFBeEI7QUFDQSxJQUFNLGNBQWMsR0FBSTtBQUNwQixFQUFBLEtBQUssRUFBRSxJQURhO0FBRXBCLEVBQUEsUUFBUSxFQUFFO0FBRlUsQ0FBeEI7QUFLQSxJQUFNLFNBQVMsR0FBUyxpQkFBeEI7QUFDQSxJQUFNLFlBQVksR0FBTSxvQkFBeEI7QUFFQSxJQUFNLFdBQVcsR0FBTyxxQkFBeEI7QUFDQSxJQUFNLFdBQVcsR0FBTyxXQUF4QjtBQUNBLElBQU0sV0FBVyxHQUFPLFNBQXhCO0FBQ0EsSUFBTSxRQUFRLEdBQVUsUUFBeEIsQyxDQUVBO0FBQ0E7O0FBRUEsSUFBSSxjQUFjLEdBQUcsQ0FBckI7QUFDQSxJQUFJLG1CQUFtQixHQUFHLEtBQTFCOztBQUNBLElBQUksZUFBZSxHQUFHLE1BQU0sQ0FBQyxPQUFQLElBQWtCLE1BQU0sQ0FBQyxXQUEvQyxDLENBRUE7QUFDQTs7O0FBRUEsU0FBUyxNQUFULENBQWdCLE1BQWhCLEVBQXdCLFdBQXhCLEVBQXFDO0FBQ2pDLE1BQUksTUFBTSxLQUFLLFNBQVgsSUFBd0IsTUFBTSxLQUFLLElBQXZDLEVBQTZDO0FBQ3pDLFVBQU0sSUFBSSxTQUFKLENBQWMseUNBQWQsQ0FBTjtBQUNIOztBQUNELE1BQUksRUFBRSxHQUFHLE1BQU0sQ0FBQyxNQUFELENBQWY7O0FBQ0EsT0FBSyxJQUFJLENBQUMsR0FBRyxDQUFiLEVBQWdCLENBQUMsR0FBRyxTQUFTLENBQUMsTUFBOUIsRUFBc0MsQ0FBQyxFQUF2QyxFQUEyQztBQUN2QyxRQUFJLFVBQVUsR0FBRyxTQUFTLENBQUMsQ0FBRCxDQUExQjs7QUFDQSxRQUFJLFVBQVUsS0FBSyxTQUFmLElBQTRCLFVBQVUs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QUssUUFBTCxDQUFjLFFBQXhELElBQW9FLEtBQUssUUFBTCxDQUFjLFNBQWQsQ0FBd0IsUUFBeEIsQ0FBaUMsV0FBakMsQ0FBaEY7O0FBQ0EsVUFBSSxJQUFKLEVBQVU7QUFDTixhQUFLLFFBQUwsQ0FBYyxTQUFkLENBQXdCLE1BQXhCLENBQStCLFdBQS9COztBQUNBLGFBQUssVUFBTCxHQUFrQixVQUFVLENBQUMsWUFBTTtBQUFFLFVBQUEsTUFBSSxDQUFDLElBQUw7QUFBYSxTQUF0QixFQUF3QixLQUFLLFFBQUwsQ0FBYyxLQUF0QyxDQUE1QjtBQUNILE9BSEQsTUFHTyxJQUFJLEtBQUssVUFBTCxJQUFtQixTQUF2QixFQUFrQztBQUNyQyxhQUFLLFFBQUwsQ0FBYyxTQUFkLENBQXdCLEdBQXhCLENBQTRCLFdBQTVCO0FBQ0g7QUFDSjs7O2tDQUVhLE0sRUFBUSxJLEVBQU07QUFDeEIsVUFBSSxLQUFLLEdBQUcsS0FBSyxRQUFMLENBQWMsWUFBZCxDQUEyQixJQUEzQixDQUFaOztBQUNBLFVBQUksS0FBSixFQUFXO0FBQ1AsYUFBSyxRQUFMLENBQWMsTUFBZCxJQUF3QixRQUFRLENBQUMsS0FBRCxDQUFoQztBQUNIO0FBQ0o7Ozs7S0FJTDtBQUNBOzs7QUFFQSxNQUFNLENBQUMsWUFBUCxHQUFzQixZQUF0QiIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsIi8vIEhJREUgT04gU0NST0xMXHJcbi8vID09PT09PT09PT09PT09XHJcblxyXG4vLyBDb25zdGFudHNcclxuLy8gLS0tLS0tLS0tXHJcblxyXG5jb25zdCBkZWZhdWx0U2VsZWN0b3IgPSAnLmhpZGUtb24tc2Nyb2xsJztcclxuY29uc3QgZGVmYXVsdE9wdGlvbnMgID0ge1xyXG4gICAgZGVsYXk6IDIwMDAsXHJcbiAgICBwb3NpdGlvbjogMFxyXG59O1xyXG5cclxuY29uc3QgYXR0ckRlbGF5ICAgICAgID0gJ2RhdGEtaGlkZS1kZWxheSc7XHJcbmNvbnN0IGF0dHJQb3NpdGlvbiAgICA9ICdkYXRhLWhpZGUtcG9zaXRpb24nO1xyXG5cclxuY29uc3QgY2xhc3NIaWRkZW4gICAgID0gJ2lzLWhpZGRlbi1vbi1zY3JvbGwnO1xyXG5jb25zdCBjbGFzc0xvY2tlZCAgICAgPSAnaXMtbG9ja2VkJztcclxuY29uc3QgY2xhc3NOb0FuaW0gICAgID0gJ25vLWFuaW0nO1xyXG5jb25zdCBjbGFzc1RvcCAgICAgICAgPSAnYXQtdG9wJztcclxuXHJcbi8vIFN0YXRpYyBNZW1iZXJzXHJcbi8vIC0tLS0tLS0tLS0tLS0tXHJcblxyXG5sZXQgX2luc3RhbmNlQ291bnQgPSAwO1xyXG5sZXQgX2lzU2Nyb2xsaW5nVXB3YXJkcyA9IGZhbHNlO1xyXG5sZXQgX3Njcm9sbFBvc2l0aW9uID0gd2luZG93LnNjcm9sbFkgfHwgd2luZG93LnBhZ2VZT2Zmc2V0O1xyXG5cclxuLy8gVXRpbGl0eSBNZXRob2RzXHJcbi8vIC0tLS0tLS0tLS0tLS0tLVxyXG5cclxuZnVuY3Rpb24gYXNzaWduKHRhcmdldCwgZmlyc3RTb3VyY2UpIHtcclxuICAgIGlmICh0YXJnZXQgPT09IHVuZGVmaW5lZCB8fCB0YXJnZXQgPT09IG51bGwpIHtcclxuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgY29udmVydCBmaXJzdCBhcmd1bWVudCB0byBvYmplY3QnKTtcclxuICAgIH1cclxuICAgIHZhciB0byA9IE9iamVjdCh0YXJnZXQpO1xyXG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICB2YXIgbmV4dFNvdXJjZSA9IGFyZ3VtZW50c1tpXTtcclxuICAgICAgICBpZiAobmV4dFNvdXJjZSA9PT0gdW5kZWZpbmVkIHx8IG5leHRTb3VyY2UgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBrZXlzQXJyYXkgPSBPYmplY3Qua2V5cyhPYmplY3QobmV4dFNvdXJjZSkpO1xyXG4gICAgICAgIGZvciAodmFyIG5leHRJbmRleCA9IDAsIGxlbiA9IGtleXNBcnJheS5sZW5ndGg7IG5leHRJbmRleCA8IGxlbjsgbmV4dEluZGV4KyspIHtcclxuICAgICAgICAgICAgdmFyIG5leHRLZXkgPSBrZXlzQXJyYXlbbmV4dEluZGV4XTtcclxuICAgICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG5leHRTb3VyY2UsIG5leHRLZXkpO1xyXG4gICAgICAgICAgICBpZiAoZGVzYyAhPT0gdW5kZWZpbmVkICYmIGRlc2MuZW51bWVyYWJsZSkge1xyXG4gICAgICAgICAgICAgICAgdG9bbmV4dEtleV0gPSBuZXh0U291cmNlW25leHRLZXldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRvO1xyXG59XHJcblxyXG5mdW5jdGlvbiB0b2dnbGVDbGFzcyhlbGVtZW50LCBjbGFzc05hbWUsIGZvcmNlKSB7XHJcbiAgICBpZiAoZm9yY2UpIHtcclxuICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGNsYXNzTmFtZSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIEhpZGVPblNjcm9sbFxyXG4vLyAtLS0tLS0tLS0tLS1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEhpZGVPblNjcm9sbCB7XHJcblxyXG4gICAgc3RhdGljIGdldCBpbnN0YW5jZUNvdW50KCkgeyByZXR1cm4gX2luc3RhbmNlQ291bnQ7IH1cclxuICAgIHN0YXRpYyBnZXQgaXNTY3JvbGxpbmdVcHdhcmRzKCkgeyByZXR1cm4gX2lzU2Nyb2xsaW5nVXB3YXJkczsgfVxyXG4gICAgc3RhdGljIGdldCBzY3JvbGxQb3NpdGlvbigpIHsgcmV0dXJuIF9pc1Njcm9sbGluZ1Vwd2FyZHM7IH1cclxuXHJcbiAgICBnZXQgaXRlbXMoKSB7IHJldHVybiB0aGlzLl9pdGVtczsgfVxyXG4gICAgZ2V0IG9wdGlvbnMoKSB7IHJldHVybiB0aGlzLl9vcHRpb25zOyB9XHJcbiAgICBnZXQgc2VsZWN0b3IoKSB7IHJldHVybiB0aGlzLl9zZWxlY3RvcjsgfVxyXG5cclxuICAgIGNvbnN0cnVjdG9yIChzZWxlY3RvciA9IGRlZmF1bHRTZWxlY3Rvciwgb3B0aW9ucyA9IHt9KSB7XHJcbiAgICAgICAgLy8gU2VsZWN0b3JcclxuICAgICAgICB0aGlzLl9zZWxlY3RvciA9IHNlbGVjdG9yO1xyXG4gICAgICAgIC8vIE9wdGlvbnNcclxuICAgICAgICB0aGlzLl9vcHRpb25zID0gYXNzaWduKHt9LCBkZWZhdWx0T3B0aW9ucywgb3B0aW9ucyk7XHJcbiAgICAgICAgLy8gSXRlbXNcclxuICAgICAgICB0aGlzLl9pdGVtcyA9IFtdO1xyXG4gICAgICAgIGxldCBub2RlTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbm9kZUxpc3QubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdGhpcy5faXRlbXMucHVzaChuZXcgSGlkZU9uU2Nyb2xsSXRlbSh0aGlzLCBub2RlTGlzdFtpXSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBPbiBTY3JvbGxcclxuICAgICAgICBpZiAoX2luc3RhbmNlQ291bnQgPT0gMCkge1xyXG4gICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgKGUpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVmcmVzaChlKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIF9pbnN0YW5jZUNvdW50Kys7XHJcbiAgICB9XHJcblxyXG4gICAgcmVmcmVzaChlKSB7XHJcbiAgICAgICAgbGV0IHBvc2l0aW9uID0gd2luZG93LnNjcm9sbFkgfHwgd2luZG93LnBhZ2VZT2Zmc2V0O1xyXG4gICAgICAgIGlmIChwb3NpdGlvbiA9PSBfc2Nyb2xsUG9zaXRpb24pIHJldHVybjtcclxuICAgICAgICB0b2dnbGVDbGFzcyhkb2N1bWVudC5ib2R5LCBjbGFzc1RvcCwgKHBvc2l0aW9uIDw9IDApKTtcclxuICAgICAgICBfaXNTY3JvbGxpbmdVcHdhcmRzID0gKHBvc2l0aW9uIDwgX3Njcm9sbFBvc2l0aW9uIHx8IHBvc2l0aW9uIDw9IDApXHJcbiAgICAgICAgX3Njcm9sbFBvc2l0aW9uID0gcG9zaXRpb247XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLl9pdGVtcy5sZW5ndGg7IGkrKykgdGhpcy5faXRlbXNbaV0ucmVmcmVzaCgpO1xyXG4gICAgfVxyXG5cclxufVxyXG5cclxuLy8gSGlkZU9uU2Nyb2xsSXRlbVxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tXHJcblxyXG5jbGFzcyBIaWRlT25TY3JvbGxJdGVtIHtcclxuXHJcbiAgICBnZXQgZWxlbWVudCgpIHsgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7IH1cclxuICAgIGdldCBvcHRpb25zKCkgeyByZXR1cm4gdGhpcy5fb3B0aW9uczsgfVxyXG4gICAgZ2V0IHBhcmVudCgpIHsgcmV0dXJuIHRoaXMuX3BhcmVudDsgfVxyXG5cclxuICAgIGNvbnN0cnVjdG9yKHBhcmVudCwgZWxlbWVudCkge1xyXG4gICAgICAgIHRoaXMuX3BhcmVudCA9IHBhcmVudDtcclxuICAgICAgICB0aGlzLl9lbGVtZW50ID0gZWxlbWVudDtcclxuICAgICAgICB0aGlzLl9vcHRpb25zID0gYXNzaWduKHt9LCBwYXJlbnQuX29wdGlvbnMpO1xyXG4gICAgICAgIHRoaXMuX3NldE9wdGlvbkludCgnZGVsYXknLCBhdHRyRGVsYXkpO1xyXG4gICAgICAgIHRoaXMuX3NldE9wdGlvbkludCgncG9zaXRpb24nLCBhdHRyUG9zaXRpb24pO1xyXG4gICAgfVxyXG5cclxuICAgIGNsZWFyVGltZW91dCgpIHtcclxuICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5fdGltZW91dElkKTtcclxuICAgICAgICB0aGlzLl90aW1lb3V0SWQgPSB1bmRlZmluZWQ7XHJcbiAgICB9XHJcblxyXG4gICAgaGlkZSgpIHtcclxuICAgICAgICBpZiAoX3Njcm9sbFBvc2l0aW9uIDw9IHRoaXMuX29wdGlvbnMucG9zaXRpb24gfHwgdGhpcy5fZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoY2xhc3NMb2NrZWQpKSByZXR1cm47XHJcbiAgICAgICAgdGhpcy5fdGltZW91dElkID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQuY2xhc3NMaXN0LmFkZChjbGFzc0hpZGRlbik7XHJcbiAgICB9XHJcblxyXG4gICAgcmVmcmVzaCgpIHtcclxuICAgICAgICB0aGlzLmNsZWFyVGltZW91dCgpO1xyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjbGFzc05vQW5pbSk7XHJcbiAgICAgICAgbGV0IHNob3cgPSAoX2lzU2Nyb2xsaW5nVXB3YXJkcyB8fCBfc2Nyb2xsUG9zaXRpb24gPD0gdGhpcy5fb3B0aW9ucy5wb3NpdGlvbiB8fCB0aGlzLl9lbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhjbGFzc0xvY2tlZCkpO1xyXG4gICAgICAgIGlmIChzaG93KSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2VsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjbGFzc0hpZGRlbik7XHJcbiAgICAgICAgICAgIHRoaXMuX3RpbWVvdXRJZCA9IHNldFRpbWVvdXQoKCkgPT4geyB0aGlzLmhpZGUoKSB9LCB0aGlzLl9vcHRpb25zLmRlbGF5KTtcclxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX3RpbWVvdXRJZCA9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5fZWxlbWVudC5jbGFzc0xpc3QuYWRkKGNsYXNzSGlkZGVuKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX3NldE9wdGlvbkludChvcHRpb24sIGF0dHIpIHtcclxuICAgICAgICBsZXQgdmFsdWUgPSB0aGlzLl9lbGVtZW50LmdldEF0dHJpYnV0ZShhdHRyKTtcclxuICAgICAgICBpZiAodmFsdWUpIHtcclxuICAgICAgICAgICAgdGhpcy5fb3B0aW9uc1tvcHRpb25dID0gcGFyc2VJbnQodmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbn1cclxuXHJcbi8vIEdsb2JhbHNcclxuLy8gLS0tLS0tLVxyXG5cclxud2luZG93LkhpZGVPblNjcm9sbCA9IEhpZGVPblNjcm9sbDsiXX0="}